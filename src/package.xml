<?xml version="1.0" encoding="utf-8"?>
<package name="dataBcCdc" displayName="Add-On to the epi package for BC CDC data" isAddOn="True" extendsPackage="epi" version="1.0.0">
  <transformers>
    <transformer
      name="Download"
      isPrimary="True"
      displayName="BC CDC: Download data"
      programName="Rscript"
      programArguments="data-bc-cdc.R"
      isStandalone="True"
      isRunnable ="True">
      <datafeeds>
        <datafeed name="Inputs" displayName="BC CDC Data - Inputs" dataScope="Scenario">
          <datasheets>
            <datasheet name="Inputs" displayName="BC CDC Data - Inputs" isSingleRow="True">
              <columns>
                <column name="InputID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" displayName="Scenario" dataType="Integer"/>
                <column name="MinimumTimestep" displayName="Start Date" dataType="Date" validationType="Date"/>
                <column name="MaximumTimestep" displayName="End Date" dataType="Date" validationType="Date"/>
                <column name="RegionalSummaryDataURL" displayName="Regional summary data URL" dataType="String"/>
              </columns>
              <defaultRecords>
                <record columns="RegionalSummaryDataURL" values="http://www.bccdc.ca/Health-Info-Site/Documents/BCCDC_COVID19_Regional_Summary_Data.csv"/>
              </defaultRecords>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="Outputs" displayName="BC CDC Data - Outputs" dataScope="Scenario">
          <datasheets>
            <datasheet name="Outputs" displayName="BC CDC Data - Outputs" isSingleRow="True">
              <columns>
                <column name="InputID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" displayName="Scenario" dataType="Integer"/>
                <column name="RegionalSummaryDataFile" displayName="Regional summary data file" dataType="String" isExternalFile="True"/>
                <column name="DownloadDateTime" displayName="Download date/time" dataType="Date"/>                
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
      </datafeeds>
      <pipeline>
        <datafeed name="Inputs" type="Input"/>
        <datafeed name="Outputs" type="Output"/>        
        <datafeed name="epi_DataSummary" type="Output"/>
      </pipeline>
    </transformer>
  </transformers>
  <layouts>
    <layout name="coreforms_ScenarioDatafeeds">
      <group name="bcCdcSources" displayName="BC CDC Download" appendTo="epi_Sources">
		    <item name="Inputs" displayName="Inputs"/>
		    <item name="Outputs" displayName="Outputs"/>
      </group>
      <group name="bcCdcModels" displayName="BC CDC Download" appendTo="epi_Models">
        <item name="epi_DataSummary" transformerFilter="Download"/>  
      </group>    
    </layout>
  </layouts>
</package>